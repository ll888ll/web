
Internet Protocol - Ejercicio
22
• Dirección de partida: 172.16.0.0/16
oObjetivo: Crear subredes para diferentes departamentos:
▪ Red A: 1000 hosts
▪ Red B: 500 hosts
▪ Red C: 20 hosts
▪ Red D: 2 hosts
Network Address Translation (NAT)
Network Address Translation
24
• El paso de direccionamiento IP classful a classless 
estuvo acompañado de la introducción de un mecanismo 
para permitir que varios computadores compartieran 
1 dirección IP globalmente válida: Traducción de Direcciones 
de Red (NAT, siglas en inglés). Todo esto para solucionar 
parcialmente la escasez de direcciones IP.
Network Address Translation
25
• La idea de NAT es muy simple: proveer una ilusión de 
conectividad en la operación de los host del sitio y el resto de 
Internet.
• Desde la perspectiva de un host en el sitio, Internet 
parece operar y enrutar direcciones IP privadas.
• Desde la perspectiva de Internet, el sitio parece 
estar compuesto por un único computador que tiene 
asignada una dir. IP válida.
• NAT resuelve el problema usando dos tipos de direcciones IP: 
al dispositivo NAT se le asigna una única direción 
IPglobalmente válida; a cada host del sitio se le asigna una 
única dirección IP privada
NAT – Ejemplo – Tabla de traducción
26
NAT – Ejemplo 
27
• ¿Qué pasa si hay dos equipos con la misma IP privada?
NAT – Ejemplo 
28
• ¿Qué pasa si hay dos equipos en la misma red local que 
quieren hacer una petición a un mismo recurso en internet?
Network Address and Port Translation 
(NAPT)
29
• NAPT, además de emplear las direcciones IP para diferenciar 
los tráficos hacia afuera y hacia adentro del sitio, emplea 
el número de puerto (diferenciar servicios).
• Cada entrada en la tabla tiene 5 valores: puertos origen y 
destino, IP origen y destino y protocolo de transporte.
NAPT - Problemas
30
• Conectividad extremo a extremo (DMZ, PF)
• Desempeño
• Fragmentación


Capa de red
Internet como infraestructura para 
servicios (recordando)
3
• Protocolos para manejo de aplicaciones de clientes finales (HTTP)
• Protocolos para asignación de direcciones IP (DHCP)
• Protocolos para resolución de nombres (DNS)
• Protocolos para multiplexación, transmisión confiable, control de flujo y control de errores (TCP – UDP)
• Protocolos para definición de rutas de envio de información entre redes (OSPF, IS-IS)
• Protocolos para definir direccionamiento (IP)
• Protocolos para envío de información en la red local (Ethernet)
Internet Protocol
Internet Protocol
5
• IP es el protocolo principal de la capa de red del modelo 
TCP/IP. Su función es facilitar el envío de paquetes de 
cualquier origen a cualquier destino.
• Parecido al servicio postal:
• Facilita 2 funciones:• Direccionamiento
• Enrutamiento
Internet Protocol - Encabezado
6Wikipedia - IPv4               
       
         
  
Internet Protocol - Subnetting
21
• Con subnetting de máscara fija se siguen desperdiciando 
muchas direcciones.
• Variable Length Subnet Mask (VLSM) permite crear subredes 
de máscara diferentes a partir de un subnetting sucesivo:
Internet Protocol - Ejercicio
22
• Dirección de partida: 172.16.0.0/16
oObjetivo: Crear subredes para diferentes departamentos:
▪ Red A: 1000 hosts
▪ Red B: 500 hosts
▪ Red C: 20 hosts
▪ Red D: 2 hosts
Network Address Translation (NAT)
Network Address Translation
24
• El paso de direccionamiento IP classful a classless 
estuvo acompañado de la introducción de un mecanismo 
para permitir que varios computadores compartieran 
1 dirección IP globalmente válida: Traducción de Direcciones 
de Red (NAT, siglas en inglés). Todo esto para solucionar 
parcialmente la escasez de direcciones IP.
Network Address Translation
25
• La idea de NAT es muy simple: proveer una ilusión de 
conectividad en la operación de los host del sitio y el resto de 
Internet.
• Desde la perspectiva de un host en el sitio, Internet 
parece operar y enrutar direcciones IP privadas.
• Desde la perspectiva de Internet, el sitio parece 
estar compuesto por un único computador que tiene 
asignada una dir. IP válida.
• NAT resuelve el problema usando dos tipos de direcciones IP: 
al dispositivo NAT se le asigna una única direción 
IPglobalmente válida; a cada host del sitio se le asigna una 
única dirección IP privada
NAT – Ejemplo – Tabla de traducción
26
NAT – Ejemplo 
27
• ¿Qué pasa si hay dos equipos con la misma IP privada?
NAT – Ejemplo 
28
• ¿Qué pasa si hay dos equipos en la misma red local que 
quieren hacer una petición a un mismo recurso en internet?
Network Address and Port Translation 
(NAPT)
29
• NAPT, además de emplear las direcciones IP para diferenciar 
los tráficos hacia afuera y hacia adentro del sitio, emplea 
el número de puerto (diferenciar servicios).
• Cada entrada en la tabla tiene 5 valores: puertos origen y 
destino, IP origen y destino y protocolo de transporte.
NAPT - Problemas
30
• Conectividad extremo a extremo (DMZ, PF)
• Desempeño
• Fragmentación




importante_:


IPv6
36
Mecanismo Propósito Principal ¿Cómo lo logra?
Doble Pila Coexistencia nativa
Los dispositivos tienen 
direcciones IPv4 e IPv6.
Tunelización Migración
Encapsula el paquete de un 
protocolo dentro del otro.
Traducción (NAT64) Interoperabilidad
Reescribe los encabezados 
de IPv4 a IPv6 (y viceversa) 
en un dispositivo intermedio.
IPv6
37
• Espacio de Direcciones Abundante: Resuelve el problema 
de la escasez de direcciones de IPv4.
• Rendimiento Mejorado: La simplicidad del encabezado IPv6 y 
el manejo de los encabezados de extensión hacen que el 
enrutamiento sea más eficiente.
• Autoconfiguración (SLAAC): Los dispositivos pueden generar 
su propia dirección IPv6 a partir de la dirección MAC de su 
interfaz, sin necesidad de un servidor DHCP.
• Seguridad Integrada: IPSec (un conjunto de protocolos de 
seguridad) es un requisito fundamental de la especificación de 
IPv6, aunque su uso sea opcional.
DHCP
DHCP
39
• DHCP (Dynamic Host Configuration Protocol) es el protocolo 
que permite a los dispositivos obtener automáticamente una 
dirección IP, la máscara de subred, la puerta de enlace 
predeterminada (gateway) y los servidores DNS al conectarse a 
una red.
•  DHCP elimina la tarea de configurar manualmente una IP, 
automatizando el proceso.
• Todo dispositivo que necesite conectarse a una red TCP/IP 
debe pasar por DHCP (a menos que use una dirección 
estáticamente configurada).
DHCP
40
• DHCP funciona a través de un simple intercambio de cuatro mensajes, conocido como DORA. Es 
un proceso de descubrimiento que ocurre cada vez que un dispositivo se conecta a la red.
• Discovery (Descubrimiento):
• El cliente (el dispositivo que se conecta) envía un mensaje de broadcast (a todos en la red) 
llamado DHCP Discover.
• El mensaje pregunta: "¿Hay algún servidor DHCP disponible? Necesito una dirección IP."
• Offer (Oferta):
• El servidor DHCP (o varios servidores) recibe el mensaje y responde con un mensaje DHCP 
Offer.
• El mensaje dice: "Aquí tienes una IP disponible: 192.168.1.50 (junto con una máscara, 
gateway, etc.)."
• Request (Petición):
• El cliente recibe la oferta y envía un mensaje de broadcast llamado DHCP Request.
• El mensaje dice: "Acepto la IP que me has ofrecido. Por favor, resérvala para mí."
• Acknowledgment (Confirmación):
• El servidor envía el mensaje final, DHCP ACK (Acknowledgement).
• El mensaje dice: "Confirmado. La IP es tuya por un tiempo limitado (tiempo de concesión)."
DHCP
41
• DHCP utiliza dos puertos UDP específicos para su comunicación, ya que opera en la capa de 
aplicación sobre UDP.
• Puerto de Servidor (Destino): 67 (Servidor DHCP)
• Puerto de Cliente (Origen): 68 (Cliente DHCP)
• Durante el proceso inicial DORA, el cliente envía peticiones desde el puerto 68 y el servidor 
escucha y responde a través del puerto 67.
• El protocolo DHCP está definido principalmente en el RFC 2131: "Dynamic Host Configuration 
Protocol". Este RFC de 1997 es el que especifica el mecanismo de asignación automática de 
direcciones IP y la gestión de la configuración de red.
• DHCP es un protocolo de la Capa de Aplicación que se monta directamente sobre UDP en la 
capa de transporte.
• Capa de Aplicación (DHCP)
• Capa de Transporte (UDP): DHCP utiliza UDP (User Datagram Protocol), no TCP.
• El proceso inicial de DHCP (el mensaje Discover) se envía como un broadcast antes de que el cliente tenga una dirección 
IP válida. Dado que no se necesita una conexión fiable (el cliente simplemente reenvía el mensaje si no recibe una 
respuesta), UDP es más rápido y adecuado para el broadcast.
DHCP
42
• Las direcciones IP asignadas por DHCP no son permanentes; 
se dan por un periodo de tiempo determinado (el tiempo de 
concesión).
• Renovación: Antes de que expire la concesión, el cliente 
intentará renovar su dirección IP. Si el servidor lo permite, el 
cliente mantiene la misma IP. Si no se puede renovar, el cliente 
debe iniciar el proceso DORA nuevamente.
• Ventaja: Esto asegura que las direcciones IP de los 
dispositivos que ya no están conectados se devuelvan al pool 
(conjunto de direcciones disponibles) para que puedan ser 
reasignadas.
DHCP - Configuración
43
• La configuración de un servidor DHCP (Dynamic Host 
Configuration Protocol) en Linux se realiza típicamente 
utilizando el paquete ISC DHCP Server.• sudo apt update
• sudo apt install isc-dhcp-server
• Se edita el archivo /etc/default/isc-dhcp-server y se escoge la 
interfaz sobre la cual se asignarán direcciones, por ejemplo:• INTERFACESv4="eth0"
• En el archivo de configuración se definen los parámetros 
principales:• option domain-name "ejemplo.local";: Nombre de dominio.
• option domain-name-servers 8.8.8.8, 8.8.4.4;: Servidores DNS.
• default-lease-time 600;: Tiempo de concesión por defecto (en segundos).
• max-lease-time 7200;: Tiempo de concesión máximo.
• authoritative;: Indica que este es el servidor DHCP principal para esta red.
DHCP - Configuración
44
• En el archivo de configuración se definen los parámetros 
principales:• # Definición de la subred a la que servir
subnet 192.168.1.0 netmask 255.255.255.0 {
 # Rango de IPs que se asignarán a los clientes
 range 192.168.1.100 192.168.1.200;
•  # Puerta de enlace predeterminada para los clientes
 option routers 192.168.1.1;
•  # Dirección de broadcast de la subred
 option broadcast-address 192.168.1.255;
•  # Repite los servidores DNS si no se definieron globalmente
option domain-name-servers 192.168.1.10, 8.8.8.8;
• }
DHCP - Configuración
45
• host impresora_a {
 # Dirección MAC del dispositivo (hardware ethernet)
 hardware ethernet 00:1A:2B:3C:4D:5E;
 # IP fija que se le asignará
 fixed-address 192.168.1.25;
}
• Iniciar el servicio:• sudo systemctl status isc-dhcp-server.service
• sudo systemctl restart isc-dhcp-server
• sudo systemctl enable isc-dhcp-server